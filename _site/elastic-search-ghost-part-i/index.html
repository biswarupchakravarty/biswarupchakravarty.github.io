<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A layout example that shows off a blog page with a list of posts.">

    <title>Elastic Search + Ghost: Part I</title>

    <!-- <link rel="stylesheet" type="text/css" href="/assets/stylesheets/common/pure.css">
    <link rel="stylesheet" type="text/css" href="/assets/stylesheets/common/grids-responsive.css">
    <link rel="stylesheet" type="text/css" href="/assets/stylesheets/common/typography.css">
    <link rel="stylesheet" type="text/css" href="/assets/stylesheets/common/syntax.css">
    <link rel="stylesheet" type="text/css" href="/assets/stylesheets/common/blog.css">
    <link rel="stylesheet" type="text/css" href="/assets/stylesheets/common/styles.css"> -->

    <link rel="stylesheet" type="text/css" href="/assets/stylesheets/common/common_all.css">    
  </head>

  <body>
    <div id="layout" class="pure-g">
      <div class="sidebar pure-u-1 pure-u-md-1-4">
        <div class="header">
          <h1 class="brand-title">The Shiny Coin</h1>
          <h2 class="brand-tagline">A blog about the modern web.</h2>

          <nav class="nav">
            <ul class="nav-list">
              <li class="nav-item">
                
                  <a class="pure-button" href="/">&larr; Back Home</a>
                
              </li>
              <!-- <li class="nav-item">
                <a class="pure-button" href="http://yuilibrary.com">YUI Library</a>
              </li> -->
            </ul>
          </nav>
        </div>
      </div>

      <div class="content  pure-u-1 pure-u-md-3-4">
        <article class="post">
  <header class="post-header">
    <!-- <img class="post-avatar" alt="Biswarup Chakravarty&#x27;s avatar" height="48" width="48" data-email="biswarup.chakravarty@gmail.com"> -->
    <h1 class="post-title"><a href="/elastic-search-ghost-part-i" class="post-title-link">Elastic Search + Ghost: Part I</a></h1>
    <p class="post-meta">
      By <a href="" class="post-author">Biswarup Chakravarty</a> on <time datetime="">12 March 2015</time>
      under 
        <a class="post-tag post-tag-index-1" href="#">Elastic Search</a>
      
        <a class="post-tag post-tag-index-2" href="#">Ghost Blog</a>
      
        <a class="post-tag post-tag-index-3" href="#">JavaScript</a>
      
   </p>
   <div class="social-buttons-container">
  <ul class="social-buttons cf">
    <li>
      <a href="http://twitter.com/share" class="socialite twitter-share" data-text="Socialite.js" data-url="/elastic-search-ghost-part-i" rel="nofollow" target="_blank"><span class="vhidden"><!-- Share on Twitter --></span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=/elastic-search-ghost-part-i" class="socialite googleplus-one" data-href="/elastic-search-ghost-part-i" rel="nofollow" target="_blank"><span class="vhidden"><!-- Share on Google --></span></a>
    </li>
    <li>
      <a href="http://www.facebook.com/sharer.php?u=http://www.socialitejs.com&amp;t=Socialite.js" class="socialite facebook-like" data-href="/elastic-search-ghost-part-i" data-send="false" data-layout="button_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden"><!-- Share on Facebook --></span></a>
    </li>
    <li></li>
    <!-- <li>
    <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=/elastic-search-ghost-part-i&amp;title=Socialite.js" class="socialite linkedin-share" data-url="/elastic-search-ghost-part-i" data-counter="top" rel="nofollow" target="_blank"><span class="vhidden">Share on LinkedIn</span></a>
    </li>
    <li>
    <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=/elastic-search-ghost-part-i&amp;title=Socialite.js" class="socialite linkedin-share" data-url="/elastic-search-ghost-part-i" data-counter="top" rel="nofollow" target="_blank"><span class="vhidden">Share on LinkedIn</span></a>
    </li> -->
  </ul>
</div>
   <hr>
 </header>
 <section class="post-description">
  <p>This is the first part of a series of posts detailing how to set up <a href="http://www.elasticsearch.org/">ElasticSearch</a> and integrate it into your Ghost blog. The aim of this series is to have search as a core feature of your blog.</p>

<h2 id="introduction">Introduction</h2>

<p>Before we begin, please ensure that</p>

<ul>
  <li>you have (SSH) access to the server that is running your Ghost blog.</li>
  <li>you have the required permissions to be able to edit the Ghost source code and restart the server.</li>
  <li>you have root access on the server where you want to install Elastic Search (I’ve installed it on the same machine that hosts the blog)</li>
</ul>

<p>Elastic Search is an amazing distributed, real-time search platform and is incredible at indexing a large amount to data and performing searches across it really, really fast. It’s built on top of <a href="http://lucene.apache.org/core/">Apache Lucene</a> and is really good at full text searching as well. Data is stored in the JSON format and is retrieved via a RESTful query language. You can find the official documentation <a href="http://www.elasticsearch.org/guide/en/elasticsearch/guide/current/index.html">here</a>.</p>

<h2 id="installing-elastic-search">Installing Elastic Search</h2>

<p>I’ll be installing Elastic Search on an ubuntu 12.04 on an AWS micro instance (which also runs this blog). Installing Elastic Search is fairly simple, just follow these steps:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd</span> ~
sudo apt-get update
sudo apt-get install openjdk-7-jre-headless -y

wget https://download.elasticsearch.org/elasticsearch/elasticsearch/elasticsearch-1.0.1.deb
sudo dpkg -i elasticsearch-1.0.1.deb

sudo service elasticsearch start</code></pre></div>

<p>OK, so now you should have Elastic Search up and running on your machine. To check, send a cURL to localhost:9200. You should get back something like this:</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="p">{</span>
    <span class="s2">&quot;status&quot;</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Bevatron&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;number&quot;</span><span class="o">:</span> <span class="s2">&quot;1.0.1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;build_hash&quot;</span><span class="o">:</span> <span class="s2">&quot;5c03841c42b&quot;</span><span class="p">,</span>
        <span class="s2">&quot;build_timestamp&quot;</span><span class="o">:</span> <span class="s2">&quot;2014-02-25T15:52:53Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;build_snapshot&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="s2">&quot;lucene_version&quot;</span><span class="o">:</span> <span class="s2">&quot;4.6&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;tagline&quot;</span><span class="o">:</span> <span class="s2">&quot;You Know, for Search&quot;</span>
  <span class="p">}</span></code></pre></div>

<p>Your <code>name</code> will be different (Awesome, isn’t it?!).</p>

<h2 id="working-with-elastic-search">Working with Elastic Search</h2>

<p>Before we enter/update (index) data in elastic search, we need to know what an Index is and what a Type is.</p>

<blockquote>
  <p>An index is like a ‘database’ in a relational database. It has a mapping which defines multiple types.</p>

  <p>An index is a logical namespace which maps to one or more primary shards and can have zero or more replica shards.</p>
</blockquote>

<p>To stay focused, I’ll not be getting into what an index and a type are, you can read up on that <a href="http://www.elasticsearch.org/blog/what-is-an-elasticsearch-index/">here.</a> As a gross simplification, consider an index to be the equivalent of a relational database and a type to the be equivalent of a table in that database.</p>

<h4 id="entering-data">Entering Data</h4>

<p>Alright lets put in some sample data. I’m using a Chrome extension called <a href="https://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnpjigdojojpjoooidkmcomcm?utm_source=chrome-ntp-icon">Postman</a> to make http calls.</p>

<p>To enter data, you need to send a <code>PUT</code> request to <code>http://localhost:9200///id</code>. If the index and the type do not exist, they will be created on the fly.</p>

<p><img src="/assets/images/es_i/Screen_Shot_2014_03_24_at_1_32_18_am_o.jpg" alt="Creating a document" /></p>

<p>The <code>"ok": true</code> indicates that all went well and the document was created with <code>"id": 1</code>. The index <code>posts</code> and the type <code>post</code> both were created on-the-fly while creating this document. Elastic Search also figured out the default schema (<a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/mapping.html">mapping</a>) for the type <code>post</code>.</p>

<h4 id="retrieving-data">Retrieving Data</h4>

<p>Lets retrieve the document we created in the previous step. Documents are retrieved via <code>GET</code> requests. The URL is: <code>http://localhost:9200////</code>.</p>

<p><img src="/assets/images/es_i/Screen_Shot_2014_03_24_at_1_41_15_am_o.jpg" alt="Fetching a document" /></p>

<h4 id="searching">Searching</h4>

<p>The simplest way to search is via a query string parameter to the specific index or the type.</p>

<p>Searching for the word “mango” in all types under the index <code>food</code>:</p>

<p><code>http://localhost:9200/food/_search?q=mango</code></p>

<p>Searching for the word “mango”in the type <code>fruits</code> in the index <code>food</code>:</p>

<p><code>http://localhost:9200/food/fruits/_search?q=mango</code></p>

<p>Lets search for our document:</p>

<p><img src="/assets/images/es_i/Screen_Shot_2014_03_24_at_1_48_34_am_o.jpg" alt="Searching" /></p>

<p>Lets search for something that doesn’t exist:</p>

<p><img src="/assets/images/es_i/Screen_Shot_2014_03_24_at_1_49_31_am_o.jpg" alt="Searching" /></p>

<p><strong>Note:</strong> Appending <code>pretty=true</code> to the query string makes Elastic Search pretty-print the output.</p>

<h4 id="deleting">Deleting</h4>

<p>Deletes are done via the <code>DELETE</code> verb.</p>

<p><code>DELETE</code> <code>http://localhost:9200/posts/post/1</code> will delete the post with <code>id</code> 1.</p>

<p><code>DELETE</code> <code>http://localhost:9200/posts/post</code> will delete everything under the type <code>post</code></p>

<p><code>DELETE</code> <code>http://localhost:9200/posts</code> will delete everything under the index <code>posts</code>.</p>

<p><img src="/assets/images/es_i/Screen_Shot_2014_03_24_at_1_59_48_am_o.jpg" alt="Deleting" /></p>

<h2 id="next-steps">Next Steps</h2>

<p>So we have set up Elastic Search and have covered how to perform basic CRUD. In the next chapter, we’ll extract data from the Ghost blog and index all of it into Elastic Search.</p>

<p>Keep commenting!</p>

  </section>
</article>

<footer class="post-footer">
  
  <section class="author">
    <h4></h4>
    <p></p>
  </section>
  

  <section class="comments">
    <div id="disqus_thread"></div>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  </section>
</footer>
      </div>

    </div>
    <!-- <script type="text/javascript" src="/assets/javascripts/common/md5.js"></script> -->
    <!-- <script type="text/javascript" src="/assets/javascripts/common/init.js"></script> -->

    <!-- <script type="text/javascript" src="/assets/javascripts/common/socialite.min.js"></script> -->

    <script type="text/javascript" src="/assets/javascripts/common/common_all.js"></script>
  </body>
</html>
